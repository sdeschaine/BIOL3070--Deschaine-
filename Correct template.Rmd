---
title: "Warm-up mini-Report: Mosquito Blood Hosts in \n Salt Lake City, Utah"
author: "Sara Deschaine"
date: "`r Sys.Date()`"
output:
  github_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# ABSTRACT

This study investigated whether house finches (Haemorhous mexicanus) act as important amplifying hosts of West Nile Virus (WNV) in Salt Lake City. Mosquitoes were collected using gravid and CO₂ traps, and bloodmeal sources were identified through PCR and gene sequencing. Bloodmeal analysis showed that house finches and house sparrows were the most frequent hosts, with house finches being dominant. Generalized linear models revealed a significant positive association between house finch bloodmeals and both the presence and infection rate of WNV in mosquito pools. These findings support the hypothesis that house finches serve as key amplifying hosts, contributing to higher rates of WNV transmission in local mosquito populations and highlighting their role in sustaining the WNV cycle in this region.

# BACKGROUND

West Nile Virus (WNV) is a mosquito-borne pathogen maintained in a transmission cycle between birds and mosquitoes, with occasional leak into humans and horses. “Birds serve as the natural reservoir (amplifying) hosts, while Culex species mosquitoes are the primary vectors that sustain WNV in nature”(Campbell et al., 2002). WNV was first introduced into North America in 1999 and continues to affect people today. As shown in the graph below, house finches appear to have the highest infection rates, suggesting that they may serve as important amplifying hosts.

Mosquito biology is central to understanding WNV transmission. A key difference between male and female mosquitoes is that only females feed on blood, making them the sole transmitters of WNV. To study which bird species mosquitoes are feeding on, and thus which hosts might be driving transmission, mosquitoes must first be collected. In this study, two types of traps were used: gravid traps and CO₂ traps.

Gravid traps use water infused with organic material to produce a strong odor that attracts females ready to lay eggs. Before egg-laying, however, these females must take a blood meal, meaning gravid traps are especially effective at capturing mosquitoes that have already fed on a host. CO₂ traps, on the other hand, emit carbon dioxide to mimic vertebrate respiration and attract host-seeking females. These traps are cheaper, easier to deploy, and can operate for longer periods, though they often capture mosquitoes before they have taken a blood meal.

Once collected, mosquitoes are processed to determine both infection status and feeding history. Pools of mosquitoes are homogenized and tested for WNV using Polymerase Chain Reaction (PCR). PCR is “a laboratory technique for rapidly producing (amplifying) millions to billions of copies of a specific segment of DNA, which can then be studied in greater detail” (Smith, 2024). This involves primers that target specific genome regions, allowing researchers to detect viral presence. Additionally, “gene sequencing can be used to determine the nucleotide order of a genome segment” (CDC, 2024), which helps identify the host species from which the mosquito obtained its blood meal.

If house finches act as key amplifying hosts, then mosquito trapping sites where finches are a common blood meal source should show higher proportions of WNV-positive pools. In the plot below, this prediction is supported: sites with higher rates of finch feedings also cluster at higher values on the y-axis (infection rates), compared to sites where mosquitoes feed less frequently on finches.

```{r viremia, include=TRUE, eval=TRUE, warning=FALSE, fig.align='left', fig.width=4.75, fig.height=7}
# Manually transcribe duration (mean, lo, hi) from the last table column
duration <- data.frame(
  Bird = c("Canada Goose","Mallard", 
           "American Kestrel","Northern Bobwhite",
           "Japanese Quail","Ring-necked Pheasant",
           "American Coot","Killdeer",
           "Ring-billed Gull","Mourning Dove",
           "Rock Dove","Monk Parakeet",
           "Budgerigar","Great Horned Owl",
           "Northern Flicker","Blue Jay",
           "Black-billed Magpie","American Crow",
           "Fish Crow","American Robin",
           "European Starling","Red-winged Blackbird",
           "Common Grackle","House Finch","House Sparrow"),
  mean = c(4.0,4.0,4.5,4.0,1.3,3.7,4.0,4.5,5.5,3.7,3.2,2.7,1.7,6.0,4.0,
           4.0,5.0,3.8,5.0,4.5,3.2,3.0,3.3,6.0,4.5),
  lo   = c(3,4,4,3,0,3,4,4,4,3,3,1,0,6,3,
           3,5,3,4,4,3,3,3,5,2),
  hi   = c(5,4,5,5,4,4,4,5,7,4,4,4,4,6,5,
           5,5,5,7,5,4,3,4,7,6)
)

# Choose some colors
cols <- c(rainbow(30)[c(10:29,1:5)])  # rainbow colors

# horizontal barplot
par(mar=c(5,12,2,2))  # wider left margin for names
bp <- barplot(duration$mean, horiz=TRUE, names.arg=duration$Bird,
              las=1, col=cols, xlab="Days of detectable viremia", xlim=c(0,7))

# add error bars
arrows(duration$lo, bp, duration$hi, bp,
       angle=90, code=3, length=0.05, col="black", xpd=TRUE)
```

# STUDY QUESTION and HYPOTHESIS

## Questions  
In Salt Lake City, which bird acts as a key host that increases WNV transmission?

## Hypothesis 
House finches play an important role in amplifying WNV in Salt Lake City.
  
## Prediction
If house finches function as significant amplifying hosts, we expect that mosquito trapping sites where house finches are a common bloodmeal source will show elevated rates of WNV-positive mosquito pools.

# METHODS

We first organized the mosquito blood meal data by location and bird species, summing the number of feedings at sites with and without WNV-positive pools. This information allowed us to quantify how often mosquitoes fed on each host across different locations. By preparing the data this way, we could later compare host usage between WNV-positive and WNV-negative sites in a clear, structured manner.

## Barplots

We visualized these counts using horizontal barplots, displaying blood meals for each bird species at WNV-negative and WNV-positive sites side by side. The barplots make it easy to see which hosts were most frequently fed on and whether house finches were more common at sites with WNV. This visualization helped us assess whether house finches might act as important amplifying hosts.

```{r first-analysis, warning=FALSE}
## import counts_matrix: data.frame with column 'loc_positives' (0/1) and host columns 'host_*'
counts_matrix <- read.csv("./bloodmeal_plusWNV_for_BIOL3070.csv")

## 1) Identify host columns
host_cols <- grep("^host_", names(counts_matrix), value = TRUE)

if (length(host_cols) == 0) {
  stop("No columns matching '^host_' were found in counts_matrix.")
}

## 2) Ensure loc_positives is present and has both levels 0 and 1 where possible
counts_matrix$loc_positives <- factor(counts_matrix$loc_positives, levels = c(0, 1))

## 3) Aggregate host counts by loc_positives
agg <- stats::aggregate(
  counts_matrix[, host_cols, drop = FALSE],
  by = list(loc_positives = counts_matrix$loc_positives),
  FUN = function(x) sum(as.numeric(x), na.rm = TRUE)
)

## make sure both rows exist; if one is missing, add a zero row
need_levels <- setdiff(levels(counts_matrix$loc_positives), as.character(agg$loc_positives))
if (length(need_levels)) {
  zero_row <- as.list(rep(0, length(host_cols)))
  names(zero_row) <- host_cols
  for (lv in need_levels) {
    agg <- rbind(agg, c(lv, zero_row))
  }
  ## restore proper type
  agg$loc_positives <- factor(agg$loc_positives, levels = c("0","1"))
  ## coerce numeric host cols (they may have become character after rbind)
  for (hc in host_cols) agg[[hc]] <- as.numeric(agg[[hc]])
  agg <- agg[order(agg$loc_positives), , drop = FALSE]
}

## 4) Decide species order (overall abundance, descending)
overall <- colSums(agg[, host_cols, drop = FALSE], na.rm = TRUE)
host_order <- names(sort(overall, decreasing = TRUE))
species_labels <- rev(sub("^host_", "", host_order))  # nicer labels

## 5) Build count vectors for each panel in the SAME order
counts0 <- rev(as.numeric(agg[agg$loc_positives == 0, host_order, drop = TRUE]))
counts1 <- rev(as.numeric(agg[agg$loc_positives == 1, host_order, drop = TRUE]))

## 6) Colors: reuse your existing 'cols' if it exists and is long enough; otherwise generate
if (exists("cols") && length(cols) >= length(host_order)) {
  species_colors <- setNames(cols[seq_along(host_order)], species_labels)
} else {
  species_colors <- setNames(rainbow(length(host_order) + 10)[seq_along(host_order)], species_labels)
}

## 7) Shared x-limit for comparability
xmax <- max(c(counts0, counts1), na.rm = TRUE)
xmax <- if (is.finite(xmax)) xmax else 1
xlim_use <- c(0, xmax * 1.08)

## 8) Plot: two horizontal barplots with identical order and colors
op <- par(mfrow = c(1, 2),
          mar = c(4, 12, 3, 2),  # big left margin for species names
          xaxs = "i")           # a bit tighter axis padding

## Panel A: No WNV detected (loc_positives = 0)
barplot(height = counts0,
        names.arg = species_labels, 
        cex.names = .5,
        cex.axis = .5,
        col = rev(unname(species_colors[species_labels])),
        horiz = TRUE,
        las = 1,
        xlab = "Bloodmeal counts",
        main = "Locations WNV (-)",
        xlim = xlim_use)

## Panel B: WNV detected (loc_positives = 1)
barplot(height = counts1,
        names.arg = species_labels, 
        cex.names = .5,
        cex.axis = .5,
        col = rev(unname(species_colors[species_labels])),
        horiz = TRUE,
        las = 1,
        xlab = "Bloodmeal counts",
        main = "Locations WNV (+)",
        xlim = xlim_use)

par(op)

## Keep the colors mapping for reuse elsewhere
host_species_colors <- species_colors
```
## Generalized linear model

We used generalized linear models to test whether the number of house finch blood meals predicts WNV presence (binary) or WNV positivity rate (numeric) at a site. One model treated WNV presence as a yes/no outcome, and the other tested the relationship with the actual positivity rate. These models let us formally evaluate the relationship suggested by the barplots and determine if house finch feeding is statistically associated with WNV.

```{r}
#glm with house finch alone against binary +/_
glm1 <- glm(loc_positives ~ host_House_finch,
            data = counts_matrix,
            family = binomial)
summary(glm1)

#glm with house-finch alone against positivity rate
glm2 <- glm(loc_rate ~ host_House_finch,
            data = counts_matrix)
summary(glm2)
```
# DISCUSSION

## Interpretation of the barplot

The first analysis examined the bloodmeal sources of Culex mosquitoes to determine which hosts they most frequently fed upon. Mosquitoes were collected using traps, and their bloodmeals were identified through molecular methods such as PCR and sequencing. The results, summarized in the bar graph, show that house finches had the highest number of mosquito bloodmeals, followed closely by house sparrows, with American robins and mourning doves also appearing as common hosts. In contrast, most other bird species, along with a few non-avian hosts such as humans, cows, and dogs, were represented at much lower frequencies. These findings suggest that house finches and house sparrows are the primary hosts for Culex mosquitoes in this area. Because birds serve as reservoir hosts for West Nile Virus, the high feeding rates on house finches in particular support the idea that they may act as key amplifying hosts. This interpretation aligns with the prediction that mosquito trapping sites with frequent finch feedings should show higher proportions of WNV-positive pools, a pattern that can be seen in the clustering of higher infection rates at these locations in the accompanying plot.

## Interpretation of the generalized linear model

The second analysis used generalized linear models (GLMs) to test whether the number of house finch bloodmeals was associated with West Nile Virus (WNV) in mosquito pools. In the first model, with WNV-positive pools as the response variable (binomial family), the predictor variable host_House_finch had a positive and statistically significant effect (Estimate = 0.35, SE = 0.16, z = 2.19, p = 0.029). This indicates that locations with more mosquito bloodmeals from house finches were more likely to contain WNV-positive pools. In the second model, which used infection rate as the response (Gaussian family), house finch bloodmeal counts again showed a significant positive association (Estimate = 0.027, SE = 0.0067, t = 4.13, p < 0.001). Together, these results support the prediction that house finches act as an important amplifying host: sites where mosquitoes feed more often on finches also tend to have higher WNV infection rates in mosquito populations. This pattern strengthens the conclusion that house finches may play a central role in maintaining and amplifying WNV transmission cycles in the study area.

# CONCLUSION

Overall, the results of our analyses support the hypothesis that house finches act as important amplifying hosts of West Nile Virus (WNV) in Salt Lake City. The bloodmeal data showed that mosquitoes feed disproportionately on house finches compared to other bird species, and the generalized linear models demonstrated a significant positive association between house finch bloodmeals and both the presence and rate of WNV in mosquito pools. Together, this evidence suggests that house finches play a central role in sustaining WNV transmission cycles in this region. By serving as frequent hosts and potential reservoirs, they likely contribute to higher infection rates in local mosquito populations, amplifying the risk of spillover to humans and other animals.

# REFERENCES 

1. Campbell, G. L., Marfin, A. A., Lanciotti, R. S., & Gubler, D. J. (2002). West Nile virus. The Lancet Infectious Diseases, 2(9), 519–529. https://doi.org/10.1016/s1473-3099(02)00368-7

2. CDC. (2024, April 24). What is Genomic Sequencing? Advanced Molecular Detection (AMD). https://www.cdc.gov/advanced-molecular-detection/about/what-is-genomic-sequencing.html

3. ChatGPT. OpenAI, version Jan 2025. Used as a reference for functions such as plot() and to correct syntax errors. Accessed `r Sys.Date()`.

4. Komar N, Langevin S, Hinten S, Nemeth N, Edwards E, Hettler D, Davis B, Bowen R, Bunning M. Experimental infection of North American birds with the New York 1999 strain of West Nile virus. Emerg Infect Dis. 2003 Mar;9(3):311-22. <https://doi.org/10.3201/eid0903.020628>

5. Smith, M. (2024). Polymerase Chain Reaction (PCR). National Human Genome Research Institute. https://www.genome.gov/genetics-glossary/Polymerase-Chain-Reaction-PCR

