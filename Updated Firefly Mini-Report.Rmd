---
title: "Firefly Mini-Report"
author: "Sara Deschaine"
date: "`r Sys.Date()`"
output:
  github_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Abstract

This study compared firefly abundance between northern and southern Utah to determine whether geographic location influences population levels. Using citizen science data, we categorized observations into two regions and analyzed abundance with a violin plot and Shapiro–Wilk normality tests. Northern Utah showed higher firefly counts, with more frequent high-abundance observations, while southern Utah had mostly low counts. Both regions had extremely small p-values, indicating non-normal, skewed distributions. These results support the hypothesis that northern Utah’s cooler, wetter habitats provide more suitable conditions for fireflies. The findings highlight how regional environmental differences shape local insect abundance and can help guide conservation efforts.

# Background

Fireflies are an ecologically important group of insects because they contribute to pollination, are a natural pest control agent, and are a food source for other animals. Understanding more about fireflies, including where they are most abundant in local areas, provides insight into habitat quality and guides conservation efforts. In our study we hypothesize that northern counties in Utah will have a higher abundance in fireflies compared to south. Fireflies are bioluminescent beetles that use light signals for mating and communication, this makes them sensitive to environmental changes that affect light or habitat conditions (Evans et al., 2018). “Most fireflies need moisture to complete their life cycle, preventing desiccation of vulnerable immature stages and ensuring availability of their soft-bodied invertebrate prey. Because of their reliance on moisture, fireflies are typically found near permanent water sources.”(Lewis et al., 2024). Northern Utah generally has cooler, wetter habitats, while southern Utah is hotter and drier. This supports the idea that northern regions may provide better habitat conditions for fireflies. By examining regional differences in firefly abundance, this study helps reveal how climate and habitat conditions influence local insect populations.

# Study Question and Hypothesis

## Question

Do northern counties in Utah have a higher abundance of fireflies compared to southern counties?

## Hypothesis

We hypothesize that northern counties in Utah will have a higher abundance of fireflies compared to southern counties, potentially due to differences in environmental conditions such as temperature, moisture, and habitat availability that are more favorable in the north.

## Prediction

If geographic location affects firefly abundance, then northern counties in Utah will have a noticeably greater number of fireflies than southern counties, reflecting regional differences in suitable habitat and environmental conditions.

# Methods

We obtained data from Fireflies Citizen Science in Logan, which compiles local firefly observation records. From this dataset, we extracted the relevant information on firefly abundance and county locations in Utah, which we then categorized into northern and southern regions. We drew a line from Juab County to Carbon County, defining everything north of the line as Northern Utah and everything south of it as Southern Utah. Using RStudio Cloud, we created one visualizations, a violin plot which compared firefly abundance between the north and south. Finally, we conducted a Shapiro-Wilk normality test to determine whether the observed differences were statistically significant.

## Analysis 1: Violin Plot

We visualized the data using a Violin plot, this code specifically reads in a dataset of firefly counts and regions, removes any rows with missing or blank region values, and then creates a violinplot of firefly abundance by region. The plot shows the distribution of counts on each side, with colors for each region and the y-axis capped at 50 to keep it readable.

```{r}
# Split Violin Plot (y-axis limited to 50)

library(ggplot2)
library(gghalves)
library(stringi)

# Read and clean your data
fireflies <- read.csv("Copy of firefliesUtah - Usable Data.csv", stringsAsFactors = FALSE)
colnames(fireflies) <- c("firefly_count", "region")

fireflies$region[fireflies$region == ""] <- NA
fireflies$region <- stri_trans_general(fireflies$region, "NFKC")
fireflies$region <- stri_replace_all_regex(fireflies$region, "\\p{C}", "")
fireflies$region <- gsub("\u00A0", " ", fireflies$region)
fireflies$region <- trimws(tolower(fireflies$region))
fireflies$region[fireflies$region %in% c("n", "nrth", "noth")] <- "north"
fireflies$region[fireflies$region %in% c("s", "sth", "soth")] <- "south"
fireflies$region <- factor(fireflies$region, levels = c("north", "south"))
fireflies_clean <- droplevels(subset(fireflies, !is.na(region)))

# Split violin plot
ggplot() +
  geom_half_violin(
    data = subset(fireflies_clean, region == "north"),
    aes(x = factor(1), y = firefly_count, fill = region),
    side = "l", trim = TRUE, color = "black", alpha = 0.7
  ) +
  geom_half_violin(
    data = subset(fireflies_clean, region == "south"),
    aes(x = factor(1), y = firefly_count, fill = region),
    side = "r", trim = TRUE, color = "black", alpha = 0.7
  ) +
  scale_fill_manual(values = c("north" = "#8EC9E8", "south" = "#F4A261")) +
  coord_cartesian(ylim = c(0, 50)) +   # y-axis capped at 50
  labs(
    title = "Firefly Abundance: North vs South",
    x = NULL,
    y = "Firefly Count"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    legend.position = "bottom",
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()
  )
```

## Analysis 2: Shapiro-Wilk normality test

We checked whether our data was normally distributed using the Shapiro–Wilk test. The code takes our variable, removes any missing values, and runs the test to see if the data follows a normal pattern. The test gives a p-value that tells us whether the data is close enough to normal for certain statistical tests.

```{r}
# Shapiro–Wilk tests for normality

shapiro.test(
fireflies$firefly_count[fireflies$region == "south"]
)
##
## Shapiro-Wilk normality test
##
## data: fireflies$firefly_count[fireflies$region == "south"]
## W = 0.19196, p-value < 2.2e-16
shapiro.test(
fireflies$firefly_count[fireflies$region == "north"]
)
```

# Discussion

## Intrepetation of Violin Plot

This violin plot compares firefly counts between the north and south regions. Each side shows the full distribution of counts, with wider sections representing values that occur more often. The north region (blue) has more high firefly counts, including many observations above 20 and even reaching 50. In contrast, the south region (orange) has most of its counts clustered below about 15, with far fewer high-count observations. Overall, the plot suggests that fireflies are generally more abundant in the north than in the south.

## Intrepetation of Shapiro-Wilk normality test

Both Shapiro–Wilk tests produced extremely small p-values (south: p = 3.04 × 10⁻¹⁶, north: p < 2.2 × 10⁻¹⁶), which are far below the 0.05 significance level. These very small p-values indicate strong evidence that the firefly counts in both regions do not follow a normal distribution. In other words, the data deviate substantially from a bell-shaped curve, likely because firefly counts are heavily skewed and include many low values with a few very high ones. Because of this, statistical methods that assume normality would not be appropriate for these data.

# Conclusion

Our study found regional differences in firefly abundance across Utah. The violin plot showed that northern counties generally have higher firefly counts, with many observations above 20 and some reaching 50, while southern counties mostly had counts below 15. This pattern supports our hypothesis that northern Utah, with its cooler and wetter habitats, provides more favorable environmental conditions for fireflies compared to the hotter, drier south. We however felt like this graph didn't represent our data correctly so we ran the Shaprio-Wilks test.

The Shapiro-Wilk tests confirmed that firefly counts in both regions are not normally distributed (p ≪ 0.05), indicating that abundance is highly skewed, with many low values and a few high observations. This suggests that firefly populations are patchily distributed and may be strongly influenced by local habitat conditions, such as moisture availability and proximity to water sources.

Overall, our results highlight that geographic and environmental factors play a significant role in shaping firefly abundance. These findings contribute to understanding how habitat quality affects local insect populations and can inform conservation efforts, particularly in regions where firefly populations may be limited by unfavorable conditions.

# References

1.  ChatGPT. OpenAI, version Jan 2025. Used as a reference for functions such as plot() and to correct syntax errors. Accessed `r Sys.Date()`

2.  Evans, T. R., Salvatore, D., van de Pol, M., & Musters, C. J. M. (2018). Adult firefly abundance is linked to weather during the larval stage in the previous year. Ecological Entomology, 44(2), 265–273. <https://doi.org/10.1111/een.12702>

3. Natural History Museum of Utah. (n.d.). Fireflies of Utah – Citizen Science
Project. https://nhmu.utah.edu/citizen-science/fireflies

4.  Lewis, S. M., Jusoh, W. F. A., Walker, A. C., Fallon, C. E., Joyce, R., & Yiu, V. (2024). Illuminating Firefly Diversity: Trends, Threats and Conservation Strategies. Insects, 15(1), 71. <https://doi.org/10.3390/insects15010071>
